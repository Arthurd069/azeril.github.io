<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在遙遠的地方 一切虔誠終必相遇">

    <title>VPS 初相遇 - Microdust</title>

    <link rel="canonical" href="http://localhost:4000/blog/Start-With-My-First-VPS.html">

    <!-- Icons -->
  <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Microdust</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/About.html">About</a>
                </li>
                
                <li>
                    <a href="/Tools.html">Tools</a>
                </li>
                
                <li>
                    <a href="/tags.html">Tags</a>
                </li>
                

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/fantasy.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="Tags">
                        
                        <a class="tag" href="/Tags/#Coding" title="Coding">Coding</a>
                        
                        <a class="tag" href="/Tags/#Linux" title="Linux">Linux</a>
                        
                    </div>
                    <h1>VPS 初相遇</h1>
                    
                    <span class="meta">Posted by Azeril on March 13, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">

                <h2 id="为什么使用-vps">为什么使用 VPS</h2>

<p>其实购置 VPS 的念想是由来已久的。至于为何过去几年里最终都没动手，更多只能归结为懒…</p>

<p>VPS 的用途广泛，小到作为同步的云盘、小型博客，大到布局网站、下载站、应用服务托管等，都能顺应自如。至于说是什么促成了我这一回下单，更多是出于熟悉 Linux 服务器的操作，为后边捋顺从开发倒部署上线的整个流程打下一点基础。日常的话，也可以多一个除了 GitHub 之外的试验场。</p>

<h2 id="vps-的选购">VPS 的选购</h2>

<p>VPS 服务的网络服务商不少，按照自己的喜好和需求来即可。</p>

<p>就选购时的衡量来说，单纯自用也最好是满足两个条件，配置相对好（符合需求的前提），价格尽量低，听起来怎么像不给吃草还让疯跑的想法？但事实如此，稍微挑选一下，还是能找到合适的套餐的，合适就好。这次是选购了 <a href="https://bandwagonhost.com">Bandwagonhost</a> 的。另外有一家 <a href="https://www.vultr.com/">Vultr</a> 也不错。</p>

<p>国内的主机或弹性云计算服务器与这一类 VPS 类似，诸如阿里云、百度云或腾讯云都在提供相应的服务。就价格而言，国内的服务器售价更高，优势是服务器布局在中国，国内访问会更好。当然，就实际的使用我发现搬瓦工的网络还不赖，进行操控和传输，参数都很可观，甚至于用这个 VPS 搭建的私人 Shadowsocks 服务，自用体验也还可以。</p>

<h2 id="初步配置">初步配置</h2>

<ul>
  <li>安装系统</li>
  <li>一键安装 Shadowsocks 服务</li>
</ul>

<p>这些操作其实没啥好说的，BandwagonHost 提供了很简明的操作面板，根据菜单的选项操作就能很容易完成系统的安装或切换。</p>

<p><img src="http://dreamofbook.qiniudn.com/BandwagonHostKiwiVMUIInstallOS.png" alt="BandwagonHostKiwiVMUI" /></p>

<p>需要注意的一点是，一键安装 Shadowsokcs 服务，只支持 CentOS 6 的版本（默认安装的服务器操作系统也是这个），安装其它的版本或其它 Linux OS 一键安装服务会失效。至于选择什么操作系统，这事见仁见智。以前在个人电脑上安装的虚拟机或实体 Linux 系统一直都是 Ubuntu。但这次为了偷懒，直接可以不折腾就部署好 Shadowsocks 服务，就直接使用了以前从来没接触过的 CentOS，操作起来也还不赖。当然，没有图形界面，这个没办法，甚至都不好意思吐槽，毕竟各种操作，我想不出比命令行更方便的途径了…</p>

<h2 id="ssh-登录-vps">SSH 登录 VPS</h2>

<p>虽然搬瓦工提供了网页版的终端方便操作，当相比 macOS 下的 iTerm 来说，便利性还是相差太多了。通过 SSH 与 VPS 进行连接，能很大程度为 VPS 的操控提供便利——这样就又能使用 iTerm 和 zsh 一类的神器了。</p>

<p>初次使用 SSH 登录新购置的 VPS 时，耗了不少时间在登录命令上。这个跟头摔的有点猝不及防…</p>

<p>初翻了几篇教程，都没细说 SSH 登录的命令格式。自己找了一下，格式是这样：<code class="highlighter-rouge">ssh &lt;username&gt;@&lt;Serverdomain/IP&gt; -p &lt;port&gt;</code></p>

<p>先前为了力求个性化，毕竟第一次购置 VPS，也是蛮值得纪念的一件事，便顺手将主机名(Hostname)改成了 stardust，一部我非常喜欢的小说的名字。然后，惯性使然，加之控制面板那边又的确是明确说了这是 Hostname，在使用 SSH 的时候我也就想当然地将自己新冠名的主机名作为 username 填上去了。接下来就是几个小时的僵持和我的好一阵烦躁…数次在控制面板修改 root password，数次试图通过切换 Linux 系统或版本来绕过一次次在用 SSH 链接时，输入密码确认，每一次都是错误（Permission denied），每累积三次错误就关闭 SSH 访问请求…购置 VPS，开启自己个人 Shadowsocks 服务的喜悦还没来得及在脸上舒展开就被这一阵折腾雨打风吹去…</p>

<p>隔了一晚，今天中午时再试，总想求得一个结果啊。这回长了心眼，重新审视了一下登录用的命令。后边再扩大关键词，搜索更多相关问答翻找了好多才在 V 站找到了破题点——<a href="https://www.v2ex.com/t/224479">《SSH 无法登陆， SFTP 正常 - V2EX》</a>。实际上用户名对应位置应该填写的就是 root 而不是自己创建的 hostname，填 root 就是这么简单粗暴…</p>

<p>当然这个不同主机估计会有差异，这里只针对搬瓦工运营的 VPS。</p>

<p>改好之后就通过远程访问，确认密码后顺利进入系统…泪目。</p>

<h2 id="为-vps-配置公共密钥">为 VPS 配置公共密钥</h2>

<p>解决了 SSH 登录的问题，后边就主要看自己想怎么个瞎折腾了。估计网站博客应用什么的都会一点点玩起来。不过现在还是先解决一个日常访问主机时需要面对的问题。每次 SSH 都需要输控制面板随机生成的密码，输入麻烦不说，自己又记不住，在找密码复制粘贴中平白浪费不少功夫。</p>

<p>先前看的各种教程中有提及使用公共密钥免密码用 SSH 访问 VPS 的。就很来劲，id_rsa.pub 这个公共密钥老早在配置 Git 访问 GitHub 时就生成过，既然是现成的这就好办了，无非是将密钥上传到服务器对应的位置（以及修改一下命名），完成对应设定就好。</p>

<p>生成公共密钥的操作这里不赘述。主要讲一下密钥生成之后，将其添加到服务器的整个流程。</p>

<ol>
  <li>SSH 登录，在 VPS 主目录下，<code class="highlighter-rouge">mkdir .ssh</code> 创建一个 <code class="highlighter-rouge">.ssh</code> 的隐藏目录，用于放置密钥；</li>
  <li>终端切换到本地的系统主目录，用 <code class="highlighter-rouge">scp</code> 命令将生成好的公钥上传到 CentOS 的 <code class="highlighter-rouge">.ssh</code> 目录下，并将公钥重命名为 authorized_keys：
<code class="highlighter-rouge">scp -P Port_Number ~/.ssh/id_rsa.pub root@VPS_IP:~/.ssh/authorized_keys</code>，确认密码后完成上传；</li>
  <li>修改服务器端文件与文件夹的权限：</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ chmod 700 ~/.ssh
$ chmod 600 ~/.ssh/id_rsa 
</code></pre></div></div>

<h2 id="优化-vps-的登录">优化 VPS 的登录</h2>

<p>通过 SSH 访问私人服务器，除却需要费劲输入主机名、端口和老长一串 IP，多少也是记忆上的负担。这时，可以使用 alias 来为登录用的 SSH 制作简单好记的短命令，方便登录。这里设定对应的短命令为 vps：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alias vps="ssh -p 29240 root@138.128.205.122"
</code></pre></div></div>

<p>设置完成后，进行部署使之生效：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source ~/.bashrc
</code></pre></div></div>

<p>如果安装了 zsh 或 oh my zsh，则：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>source ~/.zshrc
</code></pre></div></div>

<p>设定生效之后，以后，打开 Termial，输入 vps 回车就可以直接 SSH 登录 VPS 开始玩耍了。</p>

<h2 id="参考资料">参考资料</h2>

<ul>
  <li><a href="https://www.zhihu.com/question/24284566">VPS 有什么有趣的用途？ - 知乎</a></li>
  <li><a href="https://wiki.centos.org/HowTos/Network/SecuringSSH">HowTos/Network/SecuringSSH - CentOS Wiki</a></li>
  <li><a href="https://www.centos.org/docs/5/html/Deployment_Guide-en-US/s1-ssh-configfiles.html">17.5. OpenSSH Configuration Files</a></li>
</ul>


                <hr>

                <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>进行许可。转载，请注明原作者 Azeril 及本文源链接。

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/Quick-Start-Guide-For-Writing-Environment.html" data-toggle="tooltip" data-placement="top" title="从终端开始优化 GitHub Pages 博客写作环境">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/blog/JavaScript-Getting-Start-Basic-Concept-and-Knowledge.html" data-toggle="tooltip" data-placement="top" title="JavaScript 概念入门">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Utteranc -->

                <script src="https://utteranc.es/client.js"
                        repo="Azeril/azeril.github.io"
                        issue-term="pathname"
                        theme="github-light"
                        crossorigin="anonymous"
                        async>
                </script>
                <!-- Share botton -->
                <!-- Go to www.addthis.com/dashboard to customize your tools --> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5caaedc5f9567124"></script>

            </div>
        </div>
     </div>
  </article>
</script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

  
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <!-- kill the Facebook and Weibo -->
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://github.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <!--
                    
                    <li>
                        <a href="http://www.douban.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-douban fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    <!--
                    
                    <li>
                        <a href="https://www.facebook.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    

                    <!--
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                </ul>
                <p class="copyright text-muted">
                &copy; 2011~2019 Azeril ♪ Powered by Jekyll.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>




<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js",function(){
        hljs.initHighlightingOnLoad();
    })
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">


</body>

</html>